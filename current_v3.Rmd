---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library("hadron")
source("morefunctions.R")
```

Make a filelist
```{r filelist}
filelist <- getorderedfilelist(path="/home/gross/Documents/heavymesons/out_th0/", 
        basename="b", ending="/mes_contr_H_C_S_H")
filelist2 <- getorderedfilelist(path="/home/gross/Documents/heavymesons/out_th0/", 
        basename="a", ending="/mes_contr_H_C_S_H")
filelist <- c(filelist, filelist2)

filelist <- substr(filelist, 1, nchar(filelist[1])-17)

tsink <- 64
tins <- 48
bootl <- 10
# print(filelist)

```

Only 199 files, b712 (?) did not run properly, but maybe not worth the time to redo it because the signal is bad anyway
Read in data for vector currents


define function for arbitrary mu, nu
In Antonios note, he only mentions AA and VV, so take out mixed parts
AA and VV are weighted with renormalizations factors
reformulate Antonios note:

$Y^2(t)=\frac{M_{D_s}}{\exp(M_{D_s}\cdot dt)}\frac{\hat{w}_0^2}{C_2(t)}\left(Z_V^2C_4^{V_0V_0}(t) + Z_A^2C_4^{A_0A_0}(t)\right)$
```{r}
##four point function is not symmetric, do not symmetrise, also take care of divison
getcmunu <- function(filellist, Time=128, mu=0, nu=0, boot.R=100, print=FALSE, boot.l=10, ZA, ZV, dZA, dZV, theta = 0, w2 = 1){
aa <- readnissatextcf(filelist, smear_combs_to_read=c(paste("mes_contr_H_C_Dth", theta, "_A_C_P_H_H_S_H", sep="")), Time=Time, 
        corrtype="general", symmetrise=FALSE, sym.vec=c(1), 
        # combs_to_read=data.frame(op1_idx="C_H", op2_idx=paste("Dth", theta, "_A", mu, "_C_P_H_H_S_H", sep=""), spin_comb="P5P5"))
        combs_to_read=data.frame(op1_idx="C_H", op2_idx=paste("Dth", theta, "_A", nu, "_C_P_H_H_S_H", sep=""), spin_comb=paste("A", mu, "P5", sep="")))
aa <- bootstrap.cf(aa, boot.R=boot.R, boot.l=boot.l)

vv <- readnissatextcf(filelist, smear_combs_to_read=c(paste("mes_contr_H_C_Dth", theta, "_V_C_P_H_H_S_H", sep="")), Time=Time, 
        corrtype="general", symmetrise=FALSE, sym.vec=c(1), 
        # combs_to_read=data.frame(op1_idx="C_H", op2_idx=paste("Dth", theta, "_V", mu, "_C_P_H_H_S_H", sep=""), spin_comb="P5P5"))
        combs_to_read=data.frame(op1_idx="C_H", op2_idx=paste("Dth", theta, "_V", nu, "_C_P_H_H_S_H", sep=""), spin_comb=paste("V", mu, "P5", sep="")))
vv <- bootstrap.cf(vv, boot.R=boot.R, boot.l=boot.l)

bootstrapZA <- parametric.bootstrap(boot.R, c(ZA), c(dZA))
bootstrapZV <- parametric.bootstrap(boot.R, c(ZV), c(dZV))
# print(dim(bootstrapZA))
# print(dim(aa$cf.tsboot$t))

aa <- multiplycfbootstrap(cf = aa, central = ZA^2 * w2, bootstraps = bootstrapZA^2 * w2)
vv <- multiplycfbootstrap(cf = vv, central = ZV^2 * w2, bootstraps = bootstrapZV^2 * w2)


plusterms <- add.cf(aa, vv)
if(print){
print("vv")
print(vv$cf.tsboot$t0)
print("vv-error")
print(vv$cf.tsboot$se)
print("aa")
print(aa$cf.tsboot$t0)
}
return (plusterms)
}
```


How to get $w_0$? Here, it is 1.
```{r}
#plot(czerozero, log="y")
ZA <- 0.74294
dZA <- 0.00024
ZV <- 0.706379
dZV <- 0.000024
ZA <- 1
ZV <- 1
dZA <- 0
dZV <- 0
czerozero <- getcmunu(filellist = filelist, mu=0, nu=0, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
print(czerozero)
plot(czerozero, xlab="t/a", ylab="C_00(t)", main="C_00", xlim=c(0, 48), log="y")


```

symmetrisation makes 65 timeslices out of 128: measure from 0..127, 0 stays the same, 1+127, 2+126, ..., 64 stays the same -> now frm 0..64, 65 times. Do not symmetrise four-point function, symmetrisation does not make sense with more than one inserted time. But do symmetrise two-point-function to get better signal for mass, matrix element, unsymmetrise later to get values for all timeslices. Calculate smeared-smeared and local-smeared contribution to determine masses, influence of smearing.

```{r}
# scalarlocal <- readnissatextcf(filelist, smear_combs_to_read=c("/mes_contr_H_C_S_H"), Time=128,
#                 corrtype="general", combs_to_read=data.frame(op1_idx="C_H", op2_idx="S_H", spin_comb="P5P5"),
#                 symmetrise=TRUE, sym.vec=c(1))
# scalarlocal <- bootstrap.cf(scalarlocal, boot.R=100, boot.l=bootl)
scalarsmeared <- readnissatextcf(filelist, smear_combs_to_read=c("/mes_contr_H_C_H_H_S_H"), Time=128,
                corrtype="general", combs_to_read=data.frame(op1_idx="C_H", op2_idx="H_H_S_H", spin_comb="P5P5"),
                symmetrise=TRUE, sym.vec=c(1))
scalarsmeared <- bootstrap.cf(scalarsmeared, boot.R=100, boot.l=bootl)
scalarsmearedalltimeslices <- unsymmetrise.cf(scalarsmeared)

print(scalarsmeared$cf[1, ])
# plot(scalarlocal, log="y", xlab="t/a", ylab="C(t)", main="smeared-smeared two point function")
plot(scalarsmeared, log="y", xlab="t/a", ylab="C(t)", main="smeared-local two point function")
```

get two-point-functions, both smeared-local and smeared-smeared. Determine correlators, use effective mass to get a sense of boundaries for following matrixfit

```{r}
# scalarlocaleffmass <- bootstrap.effectivemass(scalarlocal)
scalarsmearedeffmass <- bootstrap.effectivemass(scalarsmeared)
# scalarlocaleffmass <- fit.effectivemass(scalarlocaleffmass, t1=10, t2=20)
#scalarsmearedeffmass <- fit.effectivemass(scalarsmearedeffmass, t1=14, t2=36)
scalarsmearedeffmass <- fit.effectivemass(scalarsmearedeffmass, t1=16, t2=42)
# plot(scalarlocaleffmass, ylim=c(0.79, 0.82), xlab="t/a", ylab="m_eff(t)", main="smeared-local two point function")
plot(scalarsmearedeffmass, ylim=c(0.79, 0.82), xlab="t/a", ylab="m_eff(t)", main="smeared-smeared two point function")
plot(scalarsmearedeffmass, xlab="t/a", ylab="m_eff(t)", main="smeared-smeared two point function")
# print(scalarsmearedeffmass$effMass)
summary(scalarsmearedeffmass)

```

Do matrixfits to get to $m_c$, $Z$. Fits work only for useCov=FALSE, otherwise 
Error in chol.default(M) : 
  the leading minor of order 20 is not positive definite
```{r}
# localmatrix <- matrixfit(scalarlocal, t1=10, t2=20, sym.vec=c("cosh"), useCov=FALSE)
smearmatrix <- matrixfit(scalarsmeared, t1=16, t2=42, sym.vec=c("cosh"), useCov=FALSE)
# summary(localmatrix)
summary(smearmatrix)
# plot(smearmatrix)
```

is dt t_sink - t_j > 0  or t_j-t_sink < 0?
here, $\hat{w}_0=1$.
```{r}
mds <- c(smearmatrix$t0[1], smearmatrix$t[,1])
dt <- tins-tsink
expmdsdt <- exp(mds*dt)
mdsoverexpmdsdt <- mds / expmdsdt
expovermds <- expmdsdt / mds
denom <- multiplycfbootstrap(scalarsmearedalltimeslices, expovermds[1], expovermds[2:length(mds)])
ytwo <- complexdivisionvlocal(czerozero, denom)
# ytwo <- czerozero / denom
df <- data.frame(t=seq(0,tins), val=ytwo$cf0[(tins+1):1], err=ytwo$tsboot.se[(tins+1):1])
plot(ytwo, xlim=c(0, 20), log="y")
plotwitherror(x=df$t, y=df$val, dy=df$err, log="y", xlab="t2-t1", ylab="Y^2")
# write.table(df, "Ytwoth0tins48.csv", row.names=F, col.names=T)
data_christiane <- data.frame(t=seq(0,127), c4=czerozero$cf0, dc4=czerozero$tsboot.se, c2=scalarsmearedalltimeslices$cf0, dc2=scalarsmearedalltimeslices$tsboot.se, ytwo = c(ytwo$cf0[(tins+1):1], rep(NA, 127-tins)), dy2=c(ytwo$tsboot.se[(tins+1):1], rep(NA, 127-tins)))
head(ytwo$cf0[(tins+1):1])
head(ytwo$tsboot.se[(tins+1):1])
```

y^4 Im(-03+30)
y^5 Re=(IM(12)-IM(21)) / 2
y^1 11 +22
```{r}
cthreethree <- getcmunu(filellist = filelist, mu=3, nu=3, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
czerothree <- getcmunu(filellist = filelist, mu=0, nu=3, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
cthreezero <- getcmunu(filellist = filelist, mu=3, nu=0, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
coneone <- getcmunu(filellist = filelist, mu=1, nu=1, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
conetwo <- getcmunu(filellist = filelist, mu=1, nu=2, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
ctwoone <- getcmunu(filellist = filelist, mu=2, nu=1, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
ctwotwo <- getcmunu(filellist = filelist, mu=2, nu=2, boot.R=100, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV, w2=1, boot.l=bootl)
```

```{r, eval=T}
intermedres <- data.frame(c00=czerozero$cf0, dc00=czerozero$tsboot.se,
                          c11=coneone$cf0, dc11=coneone$tsboot.se,
                          c12=conetwo$cf0, dc12=conetwo$tsboot.se,
                          c21=ctwoone$cf0, dc21=ctwoone$tsboot.se,
                          c22=ctwotwo$cf0, dc22=ctwotwo$tsboot.se,
                          c03=czerothree$cf0, dc03=czerothree$tsboot.se,
                          c30=cthreezero$cf0, dc30=cthreezero$tsboot.se,
                          c33=cthreethree$cf0, dc33=cthreethree$tsboot.se,
                          ic00=czerozero$icf0, dic00=czerozero$itsboot.se,
                          ic11=coneone$icf0, dic11=coneone$itsboot.se,
                          ic12=conetwo$icf0, dic12=conetwo$itsboot.se,
                          ic21=ctwoone$icf0, dic21=ctwoone$itsboot.se,
                          ic22=ctwotwo$icf0, dic22=ctwotwo$itsboot.se,
                          ic03=czerothree$icf0, dic03=czerothree$itsboot.se,
                          ic30=cthreezero$icf0, dic30=cthreezero$itsboot.se,
                          ic33=cthreethree$icf0, dic33=cthreethree$itsboot.se
                          )
intermedres <- intermedres / denom$cf0
intermedres <- intermedres[(tins+1):1, ]
write.table(intermedres, "intermedres_M_christiane.csv", row.names=F)
```

Maybe the problem is in the division of the imaginary parts? So far, always did complex division or divided real by real and imaginary by imaginary, but try to divide imaginary be real for yfour
```{r}
ythree <- multiplycfscalar(cthreethree, -1) / denom
# ythree <- complexdivisionvlocal(multiplycfscalar(cthreethree, -1), denom)
yfour <- multiplycfscalar(czerothree, -1)# - cthreezero
# yfour <- complexdivisionvlocal(yfour, denom)
# yfour <- yfour / denom
yfour$icfo <- yfour$icf0 / denom$cf0
yfour$itsboot.se <- yfour$itsboot.se / denom$cf0
# yfour$itsboot.se <- sqrt((yfour$itsboot.se / denom$cf0)^2 + (yfour$icf0 * denom$tsboot.se/ denom$cf0^2)^2)
yfive <- conetwo-ctwoone
# yfive <- complexdivisionvlocal(multiplycfscalar(yfive, 0.5), denom)
yfive <- multiplycfscalar(yfive, 0.5) / denom
# yone <- complexdivisionvlocal(coneone+ctwotwo, denom)
yone <- (coneone+ctwotwo+conetwo+ctwoone) / denom
# yfour <- yfour / denom
head(denom$cf.tsboot$t0)
head(ythree$cf0)
head(yfour$cf0)
```
```{r}
data_christiane$ythree <- c(ythree$cf0[(tins+1):1], rep(NA, 127-tins))
data_christiane$dy3 <- c(ythree$tsboot.se[(tins+1):1], rep(NA, 127-tins))
data_christiane$yfour <- c(yfour$icf0[(tins+1):1], rep(NA, 127-tins))
data_christiane$dy4 <- c(yfour$itsboot.se[(tins+1):1], rep(NA, 127-tins))
data_christiane$yone <- c(yone$cf0[(tins+1):1], rep(NA, 127-tins))
data_christiane$dy1 <- c(yone$tsboot.se[(tins+1):1], rep(NA, 127-tins))
data_christiane$yfive <- c(yfive$icf0[(tins+1):1], rep(NA, 127-tins))
data_christiane$dy5 <- c(yfive$itsboot.se[(tins+1):1], rep(NA, 127-tins))
data_christiane$zzero <- data_christiane$ytwo + data_christiane$ythree - 2 * data_christiane$yfour 
data_christiane$dzzero <- sqrt(data_christiane$dy2^2 + data_christiane$dy3^2 + 4 * data_christiane$dy4^2)
data_christiane$zone <- - 4 * data_christiane$yone + 2 * data_christiane$ythree - 2 * data_christiane$yfour 
data_christiane$dzone <- sqrt(16 * data_christiane$dy1^2 + 4 * data_christiane$dy3^2 + 4 * data_christiane$dy4^2)
data_christiane$ztwo <- data_christiane$ythree - 2 * data_christiane$yone 
data_christiane$dztwo <- sqrt(data_christiane$dy3^2 + 4 * data_christiane$dy1^2)
# data_christiane$zone <- -4 * data_christiane$yone + data_christiane$ytwo +3 * data_christiane$ythree - 4  *data_christiane$yfour + 2 * data_christiane$yfive
# data_christiane$dzone <- sqrt(16*data_christiane$dy1^2 + data_christiane$dy2^2 + 9 * data_christiane$dy3^2 + 4* data_christiane$dy5^2)
# data_christiane$ztwo <- -6 * data_christiane$yone + 3 * data_christiane$ythree - 2 * data_christiane$yfour + data_christiane$yfive
# data_christiane$dztwo <- sqrt(36 * data_christiane$dy1^2 + 9 * data_christiane$dy3^2 + 4 * data_christiane$dy4^2 + data_christiane$dy5^2)
data_christiane
write.table(data_christiane, "correlators_christiane_th0_tins48.csv", row.names=F, col.names=T)
```

```{r}
dataantonio <- read.table("z0_iset0_antonio.dat", header=F, col.names = c("t", "Z0", "dZ0", "Z1", "dZ1", "Z2", "dZ2"))
length(dataantonio$t)
#plotwitherror(x=dataantonio$t, y=dataantonio$Z0, dy=dataantonio$dZ0, log="y")
plotwitherror(x=dataantonio$t[1:49], y=2*(data_christiane$ytwo[1:49]-dataantonio$Z0[1:49])/(data_christiane$ytwo[1:49]+dataantonio$Z0[1:49]), dy=2*sqrt((data_christiane$ytwo[1:49]^2+dataantonio$Z0[1:49]^2)/(dataantonio$dZ0[1:49]+data_christiane$dy2[1:49])^4), ylim = c(-1, 1), main="Z_0 antonio vs ytwo christiane, relative deviation")
lines(x=seq(0, 48), y=rep(0, 49))
plotwitherror(x=dataantonio$t[1:49], y=(data_christiane$ytwo[1:49]-dataantonio$Z0[1:49]), dy=sqrt(data_christiane$dy2[1:49]^2+dataantonio$dZ0[1:49]^2), main="Z_0 antonio vs ytwo christiane")
lines(x=seq(0, 48), y=rep(0, 49))
plotwitherror(x=dataantonio$t[1:49], y=(data_christiane$ytwo[1:49]-dataantonio$Z0[1:49]), dy=sqrt(data_christiane$dy2[1:49]^2+dataantonio$dZ0[1:49]^2), ylim=c(-0.0001, 0.0001), main="Z_0 antonio vs ytwo christiane")
lines(x=seq(0, 48), y=rep(0, 49))
plotwitherror(x=dataantonio$t[1:49], y=(-data_christiane$zzero[1:49]+dataantonio$Z0[1:49]), dy=sqrt(data_christiane$dzzero[1:49]^2+dataantonio$dZ0[1:49]^2), main="Z_0 antonio vs Z_0 christiane")
lines(x=seq(0, 48), y=rep(0, 49))
plotwitherror(x=dataantonio$t[1:49], y=(-data_christiane$zone[1:49]+dataantonio$Z1[1:49]), dy=sqrt(data_christiane$dzone[1:49]^2+dataantonio$dZ1[1:49]^2), main="Z_1 antonio vs Z_1 christiane")
lines(x=seq(0, 48), y=rep(0, 49))
plotwitherror(x=dataantonio$t[1:49], y=(-data_christiane$ztwo[1:49]+dataantonio$Z2[1:49]), dy=sqrt(data_christiane$dztwo[1:49]^2+dataantonio$dZ2[1:49]^2), main="Z_2 antonio vs Z_2 christiane")
lines(x=seq(0, 48), y=rep(0, 49))
dataantonio$Z0[1:49] / data_christiane$ytwo[1:49]
```
```{r}
datacorr <- data.frame(t = seq(0, 64), mcorr = smearmatrix$CF$Cor, dmcorr = smearmatrix$CF$Err, czz = czerozero$cf.tsboot$t0[1:65], dczz = czerozero$tsboot.se[1:65])
write.table(datacorr, "datacorr_t1_16_t2_42.csv", col.names=T, row.names=F)
```
```{r}
data_a_mass <- read.table("H_iset0_antonio_2.dat", header=FALSE)
length(data_a_mass$V1)#, col.names = ("t", "m", "dm", "V4", "V5", "V6", "V7"))
plotwitherror(x=data_a_mass$V1[1:128], y=data_a_mass$V2[1:128]-smearmatrix$CF$Cor[1:128], dy=sqrt(data_a_mass$V3[1:128]**2+smearmatrix$CF$Cor[1:128]**2), main= "C_2 antonio vs christiane (from matrixfit used for determining effmass)")
plotwitherror(x=data_a_mass$V1, y=data_a_mass$V2-scalarsmearedalltimeslices$cf0, dy=sqrt(data_a_mass$V3^2+scalarsmearedalltimeslices$tsboot.se^2), ylim=c(-1e-18, 1e-18), main="C_2 antonio vs christiane(from re-symmetrised effective mass fit")
# print(data_a_mass$V2-smearmatrix$CF$Cor)
# print(sign(data_a_mass$V2-scalarsmearedalltimeslices$cf0-data_a_mass$V3))
```
```{r}
data_marco <- read.table("correlators_marco_th0_tins48.csv", header=T, sep=",")
print(data_marco)
plotwitherror(x=data_marco$t[2:64], y=data_marco$c2[2:64]-scalarsmearedeffmass$effMass[2:64], dy=sqrt(data_marco$dc2[2:64]^2+scalarsmearedeffmass$deffMass[2:64]^2), ylim=c(-0.001, 0.001), main="mass c2 marco vs christiane")
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:48], y=data_marco$c4[2:48]-data_christiane$c4[2:48], dy=sqrt(data_marco$dc4[2:48]^2+data_christiane$dc4[2:48]^2), main = "M_00 marco vs C4_00 christiane")
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
effmassc4 <- bootstrap.effectivemass(czerozero)
plotwitherror(x=data_marco$t[2:48], y=data_marco$c4[2:48]-effmassc4$effMass[2:48], dy=sqrt(data_marco$dc4[2:48]^2+effmassc4$deffMass[2:48]^2), main="M_00 marco vs effmass(ytwo) christiane")
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:48], y=data_marco$zzero[2:48]-data_christiane$ytwo[2:48], dy=sqrt(data_marco$dzzero[2:48]^2+data_christiane$dy2[2:48]^2), main="Z_0 marco vs ytwo christiane")
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:48], y=data_marco$c4[2:48]-data_christiane$ytwo[2:48], dy=sqrt(data_marco$dc4[2:48]^2+data_christiane$dy2[2:48]^2), main="M_00 marco vs ytwo christiane", ylim=c(-1e-3, 1e-3))
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:48], y=data_marco$c4[2:48]-data_christiane$ytwo[2:48], dy=data_christiane$dy2[2:48], main="M_00 marco vs ytwo christiane, error only christianes data")
plotwitherror(x=data_marco$t[2:48], y=data_marco$c4[2:48]-data_christiane$ytwo[2:48], dy=sqrt(data_marco$dc2[2:48]^2), main="M_00 marco vs ytwo christiane, error only marcos data")
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:48], y=data_marco$zzero[2:48]-dataantonio$Z0[2:48], dy=sqrt(data_marco$dzzero[2:48]^2+dataantonio$dZ0[2:48]^2), main="Z_0 marco vs Z_0 antonio")
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:49], y=data_marco$zzero[2:49]-data_christiane$zzero[2:49], dy=sqrt(data_marco$dzzero[2:49]^2+data_christiane$dzzero[2:49]^2), main="Z_0 marco vs Z_0 christiane", ylim=c(-1e-2, 1e-2))
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:49], y=data_marco$zone[2:49]-data_christiane$zone[2:49], dy=sqrt(data_marco$dzone[2:49]^2+data_christiane$dzone[2:49]^2), main="Z_1 marco vs christiane", ylim=c(-1e-2, 1e-2))
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
plotwitherror(x=data_marco$t[2:49], y=data_marco$ztwo[2:49]-data_christiane$ztwo[2:49], dy=sqrt(data_marco$dztwo[2:49]^2+data_christiane$dztwo[2:49]^2), main="Z_2 marco vs christiane", ylim=c(-1e-2, 1e-2))
lines(x=seq(0, 80), y=rep(0, 81), col=c(1))
head(data_marco$c4)
head(data_christiane$c4)
head(effmassc4$effMass)
plotwitherror(x=data_christiane$t[1:49], y=data_christiane$ytwo[1:49], dy=data_christiane$dy2[1:49], log="y", main="ytwo christiane")
print(data.frame(data_marco$zzero ,data_marco$dzzero, data_christiane$zzero, data_christiane$dzzero))
```
y^4 Im(-03+30)
y^5 Re=(IM(12)-IM(21)) / 2
y^1 11 +22

```{r}
conezero <- getcmunu(filelist, mu=0, nu=3, ZA=ZA, ZV=ZV, dZA=dZA, dZV=dZV)
conezero <- complexdivisionvlocal(conezero, denom)
data.frame(M03=conezero$cf0[(tins+1):1], dM03=conezero$tsboot.se[(tins+1):1])
```
Comparing directly the M to those of Marco:
M_21 is pretty different, but all results are zero within errors, similar for first values of C_30
